---
layout: post
title: "[8.9] 고차 함수"
---

## 고차 함수

---

**고차 함수**란 함수를 인수로 받는 함수 또는 함수를 반환하는 함수를 말합니다.

고차 함수를 사용하면 처리 패턴이 같은 작업을 추상화하여 하나로 합칠 수 있다.

## 간단한 예

---

```jsx
function joinStrings(n, f) {
  var s = "";
  for (var i = 0; i < n; i++) {
    s += f(i);
  }
  return s;
}
var digits = joinStrings(10, function (i) {
  return i;
});
var randomChars = joinStrings(8, function (i) {
  return String.fromCharCode(
    Math.floor(Math.random() * 26) + "a".charCodeAt(0)
  );
});
console.log(digits); // 01234556789
console.log(randomChars); // nszfhnwf
```

## 메모이제이션

---

```jsx
function memorize(f) {
  var cache = {};
  return function (x) {
    if (cache[x] == undefined) cache[x] = f(x);
    return cache[x];
  };
}
function isPrime(n) {
  if (n < 2) return false;
  var m = Math.sqrt(n);
  for (var i = 2; i <= m; i++) if (n % i == 0) return false;
  return true;
}
var isPrime_memo = memorize(isPrime);
var N = 1000;
for (var i = 2; i <= N; i++) isPrime_memo(i);
// 쌍둥이 소수의 목록을 출력
for (var i = 2; i + 2 <= N; i++) {
  if (isPrime_memo(i) && isPrime_memo(i + 2)) console.log(i + "," + (i + 2));
}
```

## 함수의 합성

---

```jsx
function compose(f, g) {
  return function () {
    return f.call(this, g.apply(this, arguments));
  };
}
var square = function (x) {
  return x * x;
};
var add1 = function (x) {
  return x + 1;
};
var h = compose(square, add1); // h(x)=(x+1)*(x+1)
console.log(h(2)); // 9
```

## 부분 적용

---

인수를 여러 개 받는 함수의 몇몇 인수를 상수로 지정해서 새로운 함수를 생성하는 기법

```jsx
function mul(a, b) {
  return a * b;
}
let double = mul.bind(null, 2);
console.log(double(3)); // 6
```

`mul.bind(null, 2)`를 호출하면 새로운 함수 `double`이 만들어진다.  `double`엔 컨텍스트가 `null`, 첫 번째 인수는 `2`인 `mul`의 호출 결과가 전달됩니다. 추가 인수는 ‘그대로’ 전달된다.

**컨텍스트가 없는 부분 적용**

```jsx
function partial(func, ...argsBound) {
  return function (...args) {
    // (*)
    return func.call(this, ...argsBound, ...args);
  };
}
let user = {
  firstName: "John",
  say(time, phrase) {
    console.log(`[${time}] ${this.firstName}: ${phrase}!`);
  },
};
// 시간을 고정한 부분 메서드를 추가함
user.sayNow = partial(
  user.say,
  new Date().getHours() + ":" + new Date().getMinutes()
);
user.sayNow("Hello"); // [10:00] John: Hello!
```

`partial(func[, arg1, arg2...])`을 호출하면 래퍼(`(*)`)가 반환된다. 래퍼를 호출하면 `func`이 다음과 같은 방식으로 동작한다.

- 동일한 `this`를 받습니다(`user.sayNow`는 `user`를 대상으로 호출된다).
- `partial`을 호출할 때 받은 인수(`"10:00"`)는 `...argsBound`에 전달된다.
- 래퍼에 전달된 인수(`"Hello"`)는 `...args`가 된다.

## 커링

---

커링이란 인수를 두 개 이상 받는 함수를 분해하여 인수가 하나인 함수의 중첩 함수로 변환하는 작업

```jsx
var pow = function (exponent) {
  return function (base) {
    return Math.pow(base, exponent);
  };
};
// Math.pow(base, exponent) = pow(exponent)(base)
var square = pow(2);
var sqrt = pow(0.5);
var cubicroot = pow(1 / 3);

var sum = function (a, b) {
  return a + b;
};
var a = [1, 2, 3, 4];
var abs_a = pow(0.5)(a.map(pow(2)).reduce(sum));
```
